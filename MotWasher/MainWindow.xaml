<Window x:Class="MotWasher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MotWasher"
        Height="560"
        Width="920"
        MinHeight="420"
        MinWidth="780"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver">

        <DockPanel>

                <ToolBar x:Name="Toolbar"
                         DockPanel.Dock="Top">
                        <Button Click="AddFiles_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Add files to the list (Ctrl+O)">
                                <TextBlock>
                                        <Run Text="_Add Files…"/>
                                        <Run Text=" "
                                             FontSize="10"/>
                                </TextBlock>
                        </Button>
                        <Button Click="RemoveSelected_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Remove selected files from the list (Delete)">_Remove Selected</Button>
                        <Button Click="SelectAll_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Select/deselect all files (Ctrl+A)">Select _All</Button>
                        <Button Click="ClearAll_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Clear all files from the list (Ctrl+L)">C_lear All</Button>
                        <Separator/>
                        <Button Click="Refresh_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Refresh MotW status for all files (F5)">_Refresh Status</Button>
                        <Separator/>
                        <Button Click="UnblockSelected_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Remove MotW from selected files (Ctrl+U)">_Unblock Selected</Button>
                        <Button Click="BlockSelected_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Add MotW to selected files (Ctrl+B)">_Block (Add MotW)</Button>
                        <Separator/>
                        <Button Click="OpenLogFolder_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Open the log file folder">Open _Log Folder</Button>
                        <TextBlock Text="Drag &amp; drop files here, or click Add Files…"
                                   Margin="12,0,0,0"
                                   VerticalAlignment="Center"/>
                </ToolBar>

                <DataGrid x:Name="Grid"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserSortColumns="True"
                          CanUserReorderColumns="True"
                          CanUserResizeColumns="True"
                          IsReadOnly="True"
                          SelectionMode="Extended"
                          Margin="8"
                          ItemsSource="{Binding}">

                        <DataGrid.Columns>

                                <DataGridTemplateColumn Header="✔"
                                                        Width="40"
                                                        IsReadOnly="True">
                                        <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                        <CheckBox
                                                                HorizontalAlignment="Center"
                                                                VerticalAlignment="Center"
                                                                IsChecked="{Binding Selected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Binding="{Binding Name}"
                                                    Header="File"
                                                    Width="*"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding Extension}"
                                                    Header="Ext"
                                                    Width="60"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding SizeDisplay}"
                                                    Header="Size"
                                                    Width="100"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding ModifiedLocal}"
                                                    Header="Modified"
                                                    Width="160"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding FullPath}"
                                                    Header="Path"
                                                    Width="2*"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding HasMotW}"
                                                    Header="Has MotW"
                                                    Width="90"
                                                    IsReadOnly="True"/>

                        </DataGrid.Columns>
                </DataGrid>

                <StatusBar DockPanel.Dock="Bottom">
                        <StatusBarItem>
                                <TextBlock x:Name="StatusText"
                                           Text="Ready"/>
                        </StatusBarItem>
                </StatusBar>

        </DockPanel>
</Window>
