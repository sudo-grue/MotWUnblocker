<Window x:Class="MotWasher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MotWasher - Zone Reassignment Helper"
        Height="560"
        Width="920"
        MinHeight="420"
        MinWidth="780"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver">

        <DockPanel>

                <!-- Educational Banner -->
                <Border DockPanel.Dock="Top"
                        Background="#FFF4E5"
                        BorderBrush="#FFB84D"
                        BorderThickness="0,0,0,1"
                        Padding="12,8">
                        <StackPanel>
                                <TextBlock FontWeight="Bold" Foreground="#CC6600">
                                        ‚ö†Ô∏è REMINDER: This tool is a workaround while zone policies are being configured
                                </TextBlock>
                                <TextBlock Margin="0,4,0,0" Foreground="#995500">
                                        Work with your organization to configure trusted sources via Group Policy.
                                        Files are "washed" ONE ZONE LEVEL per operation (Zone 3 ‚Üí Zone 2 ‚Üí Zone 1 ‚Üí Zone 0).
                                </TextBlock>
                        </StackPanel>
                </Border>

                <DockPanel>

                <ToolBar x:Name="Toolbar"
                         DockPanel.Dock="Top">
                        <Button Click="AddFiles_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Add files to the list (Ctrl+O)">
                                <TextBlock>
                                        <Run Text="_Add Files‚Ä¶"/>
                                </TextBlock>
                        </Button>
                        <Button Click="ClearAll_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Clear all files from the list (Ctrl+L)">C_lear All</Button>
                        <Separator/>
                        <Button Click="Refresh_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Refresh MotW status for all files (F5)">_Refresh Status</Button>
                        <Separator/>
                        <Button x:Name="WashFilesButton"
                                Click="WashFiles_Click"
                                Padding="16,6"
                                Margin="0,0,6,0"
                                FontWeight="Bold"
                                Background="#4CAF50"
                                Foreground="White"
                                ToolTip="Wash files - move down one zone level (Ctrl+W)">üßº _Wash Files (Move Down One Zone)</Button>
                        <Separator/>
                        <Button Click="OpenLogFolder_Click"
                                Padding="12,4"
                                Margin="0,0,6,0"
                                ToolTip="Open the log file folder">Open _Log Folder</Button>
                        <TextBlock Text="Drag &amp; drop files here to wash zones..."
                                   Margin="12,0,0,0"
                                   VerticalAlignment="Center"/>
                </ToolBar>

                <DataGrid x:Name="Grid"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserSortColumns="True"
                          CanUserReorderColumns="True"
                          CanUserResizeColumns="True"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          Margin="8"
                          ItemsSource="{Binding}">

                        <DataGrid.Columns>

                                <DataGridTextColumn Binding="{Binding Name}"
                                                    Header="File"
                                                    Width="*"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding Extension}"
                                                    Header="Ext"
                                                    Width="60"
                                                    IsReadOnly="True"/>
                                <DataGridTextColumn Binding="{Binding SizeDisplay}"
                                                    Header="Size"
                                                    Width="90"
                                                    IsReadOnly="True"/>

                                <!-- Current Zone with color coding -->
                                <DataGridTemplateColumn Header="Current Zone" Width="130">
                                        <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                        <Border Padding="4,2" CornerRadius="3">
                                                                <Border.Style>
                                                                        <Style TargetType="Border">
                                                                                <Style.Triggers>
                                                                                        <DataTrigger Binding="{Binding CurrentZoneId}" Value="3">
                                                                                                <Setter Property="Background" Value="#FFE5E5"/>
                                                                                        </DataTrigger>
                                                                                        <DataTrigger Binding="{Binding CurrentZoneId}" Value="2">
                                                                                                <Setter Property="Background" Value="#FFF8E1"/>
                                                                                        </DataTrigger>
                                                                                        <DataTrigger Binding="{Binding CurrentZoneId}" Value="1">
                                                                                                <Setter Property="Background" Value="#E8F5E9"/>
                                                                                        </DataTrigger>
                                                                                        <DataTrigger Binding="{Binding CurrentZoneId}" Value="0">
                                                                                                <Setter Property="Background" Value="#E3F2FD"/>
                                                                                        </DataTrigger>
                                                                                </Style.Triggers>
                                                                        </Style>
                                                                </Border.Style>
                                                                <TextBlock Text="{Binding CurrentZoneDisplay}" FontWeight="Medium"/>
                                                        </Border>
                                                </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- Arrow -->
                                <DataGridTextColumn Header="‚Üí" Width="30" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                        <Setter Property="Text" Value="‚Üí"/>
                                                        <Setter Property="FontSize" Value="16"/>
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                </Style>
                                        </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>

                                <!-- Next Zone with color coding -->
                                <DataGridTemplateColumn Header="After Wash" Width="130">
                                        <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                        <Border Padding="4,2" CornerRadius="3">
                                                                <Border.Style>
                                                                        <Style TargetType="Border">
                                                                                <Style.Triggers>
                                                                                        <DataTrigger Binding="{Binding NextZoneId}" Value="2">
                                                                                                <Setter Property="Background" Value="#FFF8E1"/>
                                                                                        </DataTrigger>
                                                                                        <DataTrigger Binding="{Binding NextZoneId}" Value="1">
                                                                                                <Setter Property="Background" Value="#E8F5E9"/>
                                                                                        </DataTrigger>
                                                                                        <DataTrigger Binding="{Binding NextZoneId}" Value="0">
                                                                                                <Setter Property="Background" Value="#E3F2FD"/>
                                                                                        </DataTrigger>
                                                                                </Style.Triggers>
                                                                        </Style>
                                                                </Border.Style>
                                                                <TextBlock Text="{Binding NextZoneDisplay}" FontWeight="Medium"/>
                                                        </Border>
                                                </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Binding="{Binding FullPath}"
                                                    Header="Path"
                                                    Width="2*"
                                                    IsReadOnly="True"/>

                        </DataGrid.Columns>
                </DataGrid>

                <StatusBar DockPanel.Dock="Bottom">
                        <StatusBarItem>
                                <TextBlock x:Name="StatusText"
                                           Text="Ready - Drop files to wash zones"/>
                        </StatusBarItem>
                </StatusBar>

                </DockPanel>
        </DockPanel>
</Window>
